!function(e){function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(n){return e[n]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,t){"use strict";t.r(n);var o=t(1),s=(t.n(o),t(5)),i=(t.n(s),t(6)),r=(t.n(i),t(7)),c=(t.n(r),t(8)),a=(t.n(c),t(9)),l=(t.n(a),t(10));t.n(l)},function(e,n,t){var o=t(2),s=t(3);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]),o(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},function(e,n,t){"use strict";function o(e){for(var n=-1,t=0;t<d.length;t++)if(d[t].identifier===e){n=t;break}return n}function s(e,n){for(var t={},s=[],i=0;i<e.length;i++){var r=e[i],c=n.base?r[0]+n.base:r[0],l=t[c]||0,u="".concat(c," ").concat(l);t[c]=l+1;var f=o(u),p={css:r[1],media:r[2],sourceMap:r[3]};-1===f?d.push({identifier:u,updater:a(p,n),references:1}):(d[f].references++,d[f].updater(p)),s.push(u)}return s}function i(e){var n=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var s=t.nc;s&&(o.nonce=s)}if(Object.keys(o).forEach((function(e){n.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(n);else{var i=u(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}return n}function r(e,n,t,o){var s=t?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=f(n,s);else{var i=document.createTextNode(s),r=e.childNodes;r[n]&&e.removeChild(r[n]),r.length?e.insertBefore(i,r[n]):e.appendChild(i)}}function c(e,n,t){var o=t.css,s=t.media,i=t.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),i&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}function a(e,n){var t,o,s;if(n.singleton){var a=m++;t=p||(p=i(n)),o=r.bind(null,t,a,!1),s=r.bind(null,t,a,!0)}else t=i(n),o=c.bind(null,t,n),s=function(){!function(e){null!==e.parentNode&&e.parentNode.removeChild(e)}(t)};return o(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;o(e=n)}else s()}}var l=function(){var e;return function(){return void 0===e&&(e=!(!(window&&document&&document.all)||window.atob)),e}}(),u=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}}(),d=[],f=function(){var e=[];return function(n,t){return e[n]=t,e.filter(Boolean).join("\n")}}(),p=null,m=0;e.exports=function(e,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=l());var t=s(e=e||[],n);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<t.length;i++){var r=o(t[i]);d[r].references--}for(var c=s(e,n),a=0;a<t.length;a++){var l=o(t[a]);0===d[l].references&&(d[l].updater(),d.splice(l,1))}t=c}}}},function(e,n,t){(n=t(4)(!1)).push([e.i,"/**\n * @Author: Joe Iannone\n * @Date:   2018-04-24T09:52:48-04:00\n * @Email:  joseph.m.iannone@gmail.com\n * @Filename: main.css\n// @Last modified time: 2019-11-25T21:21:38-05:00\n */\nbody {\n  min-width: 1148px;\n}\n\nh3 {\n  font-weight: 200;\n}\n\n.hide {\n  visibility: hidden;\n}\n\n.col1 {\n  max-width: 40px;\n  min-width: 30px;\n}\n\n.col2 {\n  max-width: 860px;\n  min-width: 786px;\n}\n\n.col3 {\n  max-width: 300px;\n  min-width: 250px;\n}\n\n.animate-display {\n  visibility: visible;\n  opacity: 1;\n  transition: all 0.5s ease-in-out;\n}\n\n.controller-btn {\n  border: 1px solid gray;\n}\n\n#title-container {\n  font-size: 18px;\n  font-weight: 100;\n}\n\n#logo-container {\n  filter: blur(0.6px);\n  width: 100%;\n}\n#logo-container #top-logo {\n  border-radius: 50%;\n  border: 1px solid gray;\n  width: 50px;\n  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);\n}\n\n.control-box label {\n  font-weight: 300;\n  min-width: 130px;\n}\n.control-box .controller-btn {\n  font-weight: 200;\n  margin: 1px;\n}\n.control-box .modal form {\n  padding: 2px;\n}\n#counter {\n  padding: 20px;\n  font-size: 40px;\n  color: gray;\n}\n\n.grid-container {\n  display: grid;\n  grid-template-columns: repeat(16, auto);\n  max-width: 854px;\n  min-width: 781px;\n}\n.grid-container .grid-item {\n  margin-left: 5px;\n  margin-bottom: 5px;\n  height: 45px;\n}\n.grid-container .board-block {\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n  border: 1px solid gray;\n  text-decoration: none;\n  color: gray;\n  font-variant-numeric: tabular-nums;\n  padding: 5px;\n  font-size: 10px;\n}\n.grid-container .board-block .key-note-container {\n  color: black;\n  font-variant: small-caps;\n}\n\n#step-key-container {\n  display: grid;\n  grid-template-columns: repeat(16, auto);\n  max-width: 854px;\n  min-width: 781px;\n}\n#step-key-container .step-key-item {\n  margin-left: 5px;\n  margin-bottom: 5px;\n  width: 48.38px;\n}\n#step-key-container .step-key-block {\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n}\n\n#startStopButton {\n  color: black;\n}\n\n#play-button {\n  font-size: 32px;\n}\n\n.mode-btn-on {\n  background-color: #4ce14c;\n}\n\n.autoMode, .syncMode {\n  animation-direction: alternate;\n  animation: blink-animation 1.2s infinite;\n  -webkit-animation: blink-animation 1.2s infinite;\n}\n\n@keyframes blink-animation {\n  50% {\n    opacity: 0.5;\n  }\n}\n@-webkit-keyframes blink-animation {\n  50% {\n    opacity: 0.5;\n  }\n}\n.selected {\n  background-color: rgba(255, 0, 0, 0.5);\n}\n\n.selected-dark {\n  background-color: red;\n}\n\n.disabled-block {\n  background-color: #a0a0a0;\n}\n\n.disabled-block-dark {\n  background-color: #ffffff;\n}\n\n.active-step {\n  background-color: rgba(0, 120, 30, 0.3);\n}\n\n.active-step-dark {\n  background-color: #00781e;\n}\n\n#steps-input .custom-range::-webkit-slider-thumb {\n  background: #bf6600;\n}\n#steps-input label span {\n  color: #bf6600;\n}\n\n#tempo-input .custom-range::-webkit-slider-thumb {\n  background: green;\n}\n#tempo-input label span {\n  color: green;\n}\n\n#vol-input .custom-range::-webkit-slider-thumb {\n  background: red;\n}\n#vol-input label span {\n  color: red;\n}\n\n#range-input .custom-range::-webkit-slider-thumb {\n  background: #007bff;\n}\n#range-input label span {\n  color: #007bff;\n}\n\n#detune-input .custom-range::-webkit-slider-thumb {\n  background: #00C4AA;\n}\n#detune-input label span {\n  color: #00C4AA;\n}\n\n#sustain-input .custom-range::-webkit-slider-thumb {\n  background: #ae37b6;\n}\n#sustain-input label span {\n  color: #ae37b6;\n}\n\n.modal-error-notification {\n  color: pink;\n}\n\n#sequences-select {\n  font-family: monospace;\n}\n\n.modal-backdrop {\n  background-color: rgba(0, 0, 0, 0.5);\n}\n\n#device-width-msg {\n  display: none;\n}\n\n@media screen and (max-device-width: 767px) {\n  #controller-container {\n    display: none;\n  }\n\n  #device-width-msg {\n    display: block;\n  }\n\n  body {\n    min-width: auto;\n  }\n}\n",""]),e.exports=n},function(e){"use strict";function n(e,n){var t=e[1]||"",o=e[3];if(!o)return t;if(n&&"function"==typeof btoa){var s=function(e){var n=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),t="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n);return"/*# ".concat(t," */")}(o),i=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[t].concat(i).concat([s]).join("\n")}return[t].join("\n")}e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o=n(t,e);return t[2]?"@media ".concat(t[2]," {").concat(o,"}"):o})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(o)for(var i,r=0;r<this.length;r++)null!=(i=this[r][0])&&(s[i]=!0);for(var c,a=0;a<e.length;a++)c=[].concat(e[a]),(!o||!s[c[0]])&&(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))},t}},function(){window.Notes=[{frequency:"16.35",sequence_no:"0",letter:"c",sign:""},{frequency:"17.32",sequence_no:"0",letter:"c",sign:"#"},{frequency:"18.35",sequence_no:"0",letter:"d",sign:""},{frequency:"19.45",sequence_no:"0",letter:"d",sign:"#"},{frequency:"20.60",sequence_no:"0",letter:"e",sign:""},{frequency:"21.83",sequence_no:"0",letter:"f",sign:""},{frequency:"23.12",sequence_no:"0",letter:"f",sign:"#"},{frequency:"24.50",sequence_no:"0",letter:"g",sign:""},{frequency:"25.96",sequence_no:"0",letter:"g",sign:"#"},{frequency:"27.50",sequence_no:"0",letter:"a",sign:""},{frequency:"29.14",sequence_no:"0",letter:"a",sign:"#"},{frequency:"30.87",sequence_no:"0",letter:"b",sign:""},{frequency:"32.70",sequence_no:"1",letter:"c",sign:""},{frequency:"34.65",sequence_no:"1",letter:"c",sign:"#"},{frequency:"36.71",sequence_no:"1",letter:"d",sign:""},{frequency:"38.89",sequence_no:"1",letter:"d",sign:"#"},{frequency:"41.20",sequence_no:"1",letter:"e",sign:""},{frequency:"43.65",sequence_no:"1",letter:"f",sign:""},{frequency:"46.25",sequence_no:"1",letter:"f",sign:"#"},{frequency:"49.00",sequence_no:"1",letter:"g",sign:""},{frequency:"51.91",sequence_no:"1",letter:"g",sign:"#"},{frequency:"55.00",sequence_no:"1",letter:"a",sign:""},{frequency:"58.27",sequence_no:"1",letter:"a",sign:"#"},{frequency:"61.74",sequence_no:"1",letter:"b",sign:""},{frequency:"65.41",sequence_no:"2",letter:"c",sign:""},{frequency:"69.30",sequence_no:"2",letter:"c",sign:"#"},{frequency:"73.42",sequence_no:"2",letter:"d",sign:""},{frequency:"77.78",sequence_no:"2",letter:"d",sign:"#"},{frequency:"82.41",sequence_no:"2",letter:"e",sign:""},{frequency:"87.31",sequence_no:"2",letter:"f",sign:""},{frequency:"92.50",sequence_no:"2",letter:"f",sign:"#"},{frequency:"98.00",sequence_no:"2",letter:"g",sign:""},{frequency:"103.83",sequence_no:"2",letter:"g",sign:"#"},{frequency:"110.00",sequence_no:"2",letter:"a",sign:""},{frequency:"116.54",sequence_no:"2",letter:"a",sign:"#"},{frequency:"123.47",sequence_no:"2",letter:"b",sign:""},{frequency:"130.81",sequence_no:"3",letter:"c",sign:""},{frequency:"138.59",sequence_no:"3",letter:"c",sign:"#"},{frequency:"146.83",sequence_no:"3",letter:"d",sign:""},{frequency:"155.56",sequence_no:"3",letter:"d",sign:"#"},{frequency:"164.81",sequence_no:"3",letter:"e",sign:""},{frequency:"174.61",sequence_no:"3",letter:"f",sign:""},{frequency:"185.00",sequence_no:"3",letter:"f",sign:"#"},{frequency:"196.00",sequence_no:"3",letter:"g",sign:""},{frequency:"207.65",sequence_no:"3",letter:"g",sign:"#"},{frequency:"220.00",sequence_no:"3",letter:"a",sign:""},{frequency:"233.08",sequence_no:"3",letter:"a",sign:"#"},{frequency:"246.94",sequence_no:"3",letter:"b",sign:""},{frequency:"261.63",sequence_no:"4",letter:"c",sign:""},{frequency:"277.18",sequence_no:"4",letter:"c",sign:"#"},{frequency:"293.66",sequence_no:"4",letter:"d",sign:""},{frequency:"311.13",sequence_no:"4",letter:"d",sign:"#"},{frequency:"329.63",sequence_no:"4",letter:"e",sign:""},{frequency:"349.23",sequence_no:"4",letter:"f",sign:""},{frequency:"369.99",sequence_no:"4",letter:"f",sign:"#"},{frequency:"392.00",sequence_no:"4",letter:"g",sign:""},{frequency:"415.30",sequence_no:"4",letter:"g",sign:"#"},{frequency:"440.00",sequence_no:"4",letter:"a",sign:""},{frequency:"466.16",sequence_no:"4",letter:"a",sign:"#"},{frequency:"493.88",sequence_no:"4",letter:"b",sign:""},{frequency:"523.25",sequence_no:"5",letter:"c",sign:""},{frequency:"554.37",sequence_no:"5",letter:"c",sign:"#"},{frequency:"587.33",sequence_no:"5",letter:"d",sign:""},{frequency:"622.25",sequence_no:"5",letter:"d",sign:"#"},{frequency:"659.25",sequence_no:"5",letter:"e",sign:""},{frequency:"698.46",sequence_no:"5",letter:"f",sign:""},{frequency:"739.99",sequence_no:"5",letter:"f",sign:"#"},{frequency:"783.99",sequence_no:"5",letter:"g",sign:""},{frequency:"830.61",sequence_no:"5",letter:"g",sign:"#"},{frequency:"880.00",sequence_no:"5",letter:"a",sign:""},{frequency:"932.33",sequence_no:"5",letter:"a",sign:"#"},{frequency:"987.77",sequence_no:"5",letter:"b",sign:""},{frequency:"1046.50",sequence_no:"6",letter:"c",sign:""},{frequency:"1108.73",sequence_no:"6",letter:"c",sign:"#"},{frequency:"1174.66",sequence_no:"6",letter:"d",sign:""},{frequency:"1244.51",sequence_no:"6",letter:"d",sign:"#"},{frequency:"1318.51",sequence_no:"6",letter:"e",sign:""},{frequency:"1396.91",sequence_no:"6",letter:"f",sign:""},{frequency:"1479.98",sequence_no:"6",letter:"f",sign:"#"},{frequency:"1567.98",sequence_no:"6",letter:"g",sign:""},{frequency:"1661.22",sequence_no:"6",letter:"g",sign:"#"},{frequency:"1760.00",sequence_no:"6",letter:"a",sign:""},{frequency:"1864.66",sequence_no:"6",letter:"a",sign:"#"},{frequency:"1975.53",sequence_no:"6",letter:"b",sign:""},{frequency:"2093.00",sequence_no:"7",letter:"c",sign:""},{frequency:"2217.46",sequence_no:"7",letter:"c",sign:"#"},{frequency:"2349.32",sequence_no:"7",letter:"d",sign:""},{frequency:"2489.02",sequence_no:"7",letter:"d",sign:"#"},{frequency:"2637.02",sequence_no:"7",letter:"e",sign:""},{frequency:"2793.83",sequence_no:"7",letter:"f",sign:""},{frequency:"2959.96",sequence_no:"7",letter:"f",sign:"#"},{frequency:"3135.96",sequence_no:"7",letter:"g",sign:""},{frequency:"3322.44",sequence_no:"7",letter:"g",sign:"#"},{frequency:"3520.00",sequence_no:"7",letter:"a",sign:""},{frequency:"3729.31",sequence_no:"7",letter:"a",sign:"#"},{frequency:"3951.07",sequence_no:"7",letter:"b",sign:""},{frequency:"4186.01",sequence_no:"8",letter:"c",sign:""},{frequency:"4434.92",sequence_no:"8",letter:"c",sign:"#"},{frequency:"4698.63",sequence_no:"8",letter:"d",sign:""},{frequency:"4978.03",sequence_no:"8",letter:"d",sign:"#"},{frequency:"5274.04",sequence_no:"8",letter:"e",sign:""},{frequency:"5587.65",sequence_no:"8",letter:"f",sign:""},{frequency:"5919.91",sequence_no:"8",letter:"f",sign:"#"},{frequency:"6271.93",sequence_no:"8",letter:"g",sign:""},{frequency:"6644.88",sequence_no:"8",letter:"g",sign:"#"},{frequency:"7040.00",sequence_no:"8",letter:"a",sign:""},{frequency:"7458.62",sequence_no:"8",letter:"a",sign:"#"},{frequency:"7902.13",sequence_no:"8",letter:"b",sign:""}]},function(){window.demo_sequences=[{title:"Katy Song",sequence_matrix:[8,16,65,67,75,98,100,102,111,122,124,151,153,165,174,189],sequence_params:{detune:0,gain:.16,key:"d",note_start:17,steps:16,sustain:3.2,tempo:155,wave:"sawtooth"}},{title:"Test",sequence_matrix:[0,2,4,7,15,38,56,82,89,101,138,143,163,177],sequence_params:{detune:-23,gain:.1,key:"e",note_start:25,steps:8,sustain:3.2,tempo:233,wave:"sawtooth"}}]},function(){window.audioCtx=new(window.AudioContext||window.webkitAudioContext),window.Board=function(){this.build(),this.sequencerBlockClickListen(),this.color_mode_value="light",this.color_mode_display_txt="dark mode",this.color_mode_btn_class="btn-light",this.saveSequenceFormModalObj={id:"save-sequence-form-modal",header:'<strong><i class="fas fa-save"></i>&nbsp; Save Sequence</strong>',body:"<div id='save-sequence-modal-body'></div>",body_id:"save-sequence-modal-body",modal_container_id:"save-sequence-modal-container",button_id:"save-sequence-modal-btn",input_id:"save-sequence-input",error_notification_id:"save-error-container",form_id:"save-sequence-form"},$("#"+this.saveSequenceFormModalObj.modal_container_id).html(this.getModal(this.saveSequenceFormModalObj)),$("#"+this.saveSequenceFormModalObj.button_id).click((function(){$("#save-sequence-input").val(""),$("#save-error-container").html(""),$("#save-sequence-form-modal").modal()})),$("#"+this.saveSequenceFormModalObj.body_id).html(this.getSaveSequenceForm()),this.getSequencesFormModalObj={id:"sequences-form-modal",header:'<strong><i class="fas fa-retweet"></i> Sequences</strong>',body:"<div id='get-sequences-modal-body'></div>",body_id:"get-sequences-modal-body",modal_container_id:"get-sequences-modal-container",button_id:"get-sequences-btn",select_id:"sequences-select",form_id:"load-sequence-form",error_notification_id:"load-delete-modal-error"},$("#"+this.getSequencesFormModalObj.modal_container_id).html(this.getModal(this.getSequencesFormModalObj)),$("#"+this.getSequencesFormModalObj.button_id).click((function(){$("#sequences-form-modal").modal()})),$("#"+this.getSequencesFormModalObj.body_id).append(this.getSequencesForm())},window.Board.prototype.getSelectedBlocks=function(){var e=[];return $(".board-block").each((function(n,t){$(t).hasClass("selected")&&e.push(n)})),e},window.Board.prototype.getModal=function(e){var n="";return n+=`\n    <div class='modal modal fade' id='${e.id}'>\n      <div class='modal-dialog'>\n        <div class='modal-content'>\n          \x3c!-- Modal Header --\x3e\n          <div class='modal-header'>\n            <div class='modal-title'>${e.header}</div>\n            <button type='button' class='close' data-dismiss='modal'>&times;</button>\n          </div>\n          \x3c!-- Modal body --\x3e\n          <div class='modal-body'>${e.body}</div>\n        </div>\n      </div>\n    </div>`},window.Board.prototype.getSequencesForm=function(){return`\n    <form ng-submit='loadSequences(selected_sequences)'>\n    <select required size='6' multiple name='selected_sequences' class='form-control form-control-sm' ng-model='selected_sequences' id='${this.getSequencesFormModalObj.select_id}'></select>\n    <input type='submit' class='btn btn-primary btn-sm mt-2 mr-1' value='Load Sequence'></input>\n    <button type='button' ng-click='deleteSequences(selected_sequences)' class='float-right btn btn-danger btn-sm mt-2 mr-1'>Delete Sequence(s)</button>\n    <div class='small pt-2'><i>* Select multiple sequences by holding Ctrl/Command to remove multiple at once</i></div>\n    <div id='load-delete-modal-error' class='pt-2 modal-error-notification'></div>\n    </form>\n  `},window.Board.prototype.getSaveSequenceForm=function(){return`\n  <form id='${this.saveSequenceFormModalObj.form_id}' ng-submit='saveSequence(save_sequence_title)'>\n    <div class='form-row'>\n      <div class='col'>\n        \x3c!--<label>Title</label>--\x3e\n        <input maxlength="36" placeholder='Sequence Title' required type='text' name='save_sequence_title' ng-model='save_sequence_title' class='form-control form-control-sm' id='${this.saveSequenceFormModalObj.input_id}'></input>\n      </div>\n      <div class='col'>\n        <input type='submit' class='btn btn-sm btn-primary' value='Save'></input>\n      </div>\n    </div>\n    <div id='save-error-container' class='pt-2 modal-error-notification'></div>\n  </form>\n  `},window.Board.prototype.toggleModeButton=function(e){var n="mode-btn-on",t="btn-light";$("#"+e).hasClass(t)?($("#"+e).removeClass(t),$("#"+e).addClass(n)):($("#"+e).removeClass(n),$("#"+e).addClass(t))},window.Board.prototype.colorMode=function(){return"light"===this.color_mode_value?(this.color_mode_value="dark",this.color_mode_display_txt="light mode",document.body.style.background="#000000",document.body.style.color="#ffffff",$(".key-note-container").css("color","#ffffff"),$(".modal-content").css("background-color","#333333"),$(".modal-header button").css("color","#ffffff"),document.getElementById("play-button").style.color="#ffffff",document.getElementById("color-mode-btn").style.background="#000000",document.getElementById("color-mode-btn").style.color="#ffffff"):(this.color_mode_value="light",this.color_mode_display_txt="dark mode",document.body.style.background="#ffffff",document.body.style.color="#000000",$(".key-note-container").css("color","#000000"),$(".modal-content").css("background-color","#ffffff"),$(".modal-header button").css("color","#000000"),document.getElementById("play-button").style.color="#000000",document.getElementById("color-mode-btn").style.background="#ffffff",document.getElementById("color-mode-btn").style.color="#000000"),{color_mode_value:this.color_mode_value,color_mode_display_txt:this.color_mode_display_txt,color_mode_btn_class:this.color_mode_btn_class}},window.Board.prototype.sequencerBlockClickListen=function(){for(var e=document.getElementsByClassName("board-block-a"),n=0;n<e.length;n++)e[n].addEventListener("click",(function(e){e.preventDefault();var n=this.childNodes[0];n.classList.contains("disabled-block")||(n.classList.contains("unselected")?(n.classList.remove("unselected"),n.classList.add("selected")):(n.classList.remove("selected"),n.classList.add("unselected")))}))},window.Board.prototype.build=function(){var e,n,t=0,o=0,s="";for(this.grid_str='<div class="grid-container">',e=0;e<192;e++)n=e%16,0==e%16&&0!=e?(t++,s='<span class="key-note-container"></span>'):0===e||(s=""),o=16>e?(n+1).toString().padStart(2,"0").padEnd(3," "):"".padEnd(3," "),this.grid_str+=`<div class="grid-item step-${n} note-${t}"><a href class="board-block-a"><div id="${t}" class="board-block unselected">${s}${o}</div></a></div>`;this.grid_str+="</div>",$("#controller").html(this.grid_str)}},function(){window.Oscillator=function(e,n,t,o,s){this.vol=window.audioCtx.createGain(),this.oscillator=window.audioCtx.createOscillator(),this.vol.gain.value=t/2,this.vol.connect(window.audioCtx.destination),"electric lullaby"===n?this.oscillator.setPeriodicWave(this.getCustomWave()):this.oscillator.type=n,this.oscillator.detune.value=o,this.sustain=s,this.oscillator.frequency.setValueAtTime(e,window.audioCtx.currentTime),this.oscillator.connect(this.vol)},Oscillator.prototype.play=function(){this.oscillator.start()},Oscillator.prototype.stop=function(){this.mute(),this.oscillator.stop(window.audioCtx.currentTime+this.sustain)},Oscillator.prototype.mute=function(){try{this.vol.gain.setTargetAtTime(0,window.audioCtx.currentTime,this.sustain),this.vol.gain.exponentialRampToValueAtTime(.01,window.audioCtx.currentTime+this.sustain)}catch(e){console.log(e),this.vol.gain.value=0}},Oscillator.prototype.getCustomWave=function(){var e=new Float32Array([1,1,1,1,1]),n=new Float32Array(e.length);return new PeriodicWave(window.audioCtx,{real:e,imag:n,disableNormalization:!1})}},function(){function e(e){if(!e.isPaused){var t,o;for(this.current_step=e.i,10>(o=e.i+1)&&(o="0"+o),document.getElementById("counter").innerHTML=o,e.current_step="step-"+e.i,e.current_col=document.getElementsByClassName(e.current_step),t=0;t<e.current_col.length;t++)e.current_col[t].classList.add("active-step");for(e.last_step=0<e.i?"step-"+(e.i-1):"step-"+(e.steps-1),e.last_col=document.getElementsByClassName(e.last_step),t=0;t<e.last_col.length;t++)e.last_col[t].classList.remove("active-step");for(e.current_notes=[],t=0;t<e.current_col.length;t++)e.current_notes.push(e.current_col[t].childNodes[0]);for(e.selected_notes=[],t=0;t<e.current_notes.length;t++)e.current_notes[t].childNodes[0].classList.contains("selected")&&e.selected_notes.push(e.current_notes[t].childNodes[0].id);for(t=0;t<e.selected_notes.length;t++)e.oscillators.current.push(new window.Oscillator(e.freqs[e.selected_notes[t]],e.wave,e.vol,e.detune,e.sustain));for(t=0;t<e.oscillators.current.length;t++)e.oscillators.current[t].play();for(t=0;t<e.oscillators.previous.length;t++)e.oscillators.previous[t].stop();e.oscillators.previous=e.oscillators.current,e.oscillators.current=[],12<$(".active-step").length&&e.clearActiveStep(),e.i++,e.i==e.steps&&(e.i=0),e.autoMode&&this.current_step==e.steps-1&&(e.auto_seed=n(Math.random()*(e.steps/2)),e.randomSelection(e.auto_seed))}}var n=Math.round;window.Sequencer=function(n){if(this.current_step=0,this.interval_val=6e4/n.tempo,this.key=n.key,this.wave=n.wave,this.vol=n.volume,this.detune=n.detune,this.sustain=n.sustain,this.steps=n.step,this.color_mode="light",this.notes=n.notes,this.autoMode=n.autoMode,this.syncMode=n.syncMode,this.notes_in_key=n.notes_in_key,this.notes_start=n.notes_start,this.freqs=[],this.auto_seed=1,null!==this.notes_in_key)for(i=this.notes_start;i<this.notes_start+12;i++)this.freqs.push(+this.notes_in_key[i].frequency);else this.freqs=[277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88,523.25];this.setKey(this.key),this.deactivateSteps(),this.isPaused=!0,this.oscillators=[],this.oscillators.current=[],this.oscillators.previous=[],this.i=0;var t=this;this.interval=setInterval((function(){e(t)}),this.interval_val)},Sequencer.prototype.pause=function(){this.mute(),this.isPaused=!0},Sequencer.prototype.resume=function(){this.isPaused=!1},Sequencer.prototype.getTempo=function(){return this.interval_val},Sequencer.prototype.setTempo=function(e){this.interval_val=6e4/e,this.resetInterval()},Sequencer.prototype.setWave=function(e){this.wave=e},Sequencer.prototype.mute=function(){var e=0;for(e=0;e<this.oscillators.previous.length;e++)this.oscillators.previous[e].stop()},Sequencer.prototype.setVol=function(e){this.vol=e},Sequencer.prototype.setDetune=function(e){this.detune=e},Sequencer.prototype.setNoteRange=function(e){for(this.notes_start=e,this.freqs=[],i=this.notes_start;i<this.notes_start+12;i++)this.freqs.push(+this.notes_in_key[i].frequency);this.updateNoteKeyDisplay()},Sequencer.prototype.setKey=function(e){this.key=e,this.notes_in_key=this.getNotesByKey(this.key),this.setNoteRange(this.notes_start)},Sequencer.prototype.getNotesByKey=function(e){var n=[];if("chromatic"==e){for(i=0;i<this.notes.length;i++)20<i&&n.push(this.notes[i]);return n}var t=[2,2,1,2,2,2,1],o=0,s="",r="";for(1<e.length?(r=(e=e.split(""))[0],s=e[1]):r=e,i=0;i<this.notes.length;i++)if(this.notes[i].letter==r&&this.notes[i].sign==s){n.push(this.notes[i]),o=i;break}for(;void 0!==this.notes[o];)for(i=0;i<t.length;i++)o+=t[i],void 0!==this.notes[o]&&n.push(this.notes[o]);return n},Sequencer.prototype.setSustain=function(e){this.sustain=e},Sequencer.prototype.getBoxes=function(){return document.querySelectorAll(".grid-item .board-block")},Sequencer.prototype.clearBoard=function(){var e,n=this.getBoxes();for(e=0;e<n.length;e++)n[e].classList.contains("selected")&&(n[e].classList.remove("selected"),n[e].classList.add("unselected"))},Sequencer.prototype.resetInterval=function(){var n=this;clearInterval(this.interval),this.interval=setInterval((function(){e(n)}),this.interval_val)},Sequencer.prototype.getAllSteps=function(){return document.getElementById("controller").childNodes[0].childNodes},Sequencer.prototype.getSelectedBlocks=function(){var e=$(".board-block"),n=[];for(i=0;i<e.length;i++)e[i].classList.contains("selected")&&n.push(i);return n},Sequencer.prototype.getActiveStep=function(){var e=this.getAllSteps(),n=0;for(n=0;n<e.length;n++)if(e[n].classList.contains("active-step")){return e[n].classList[1].split("-")[1]}},Sequencer.prototype.setSteps=function(e){this.steps=e,this.deactivateSteps(),this.i>=this.steps&&(this.i=0,this.clearActiveStep())},Sequencer.prototype.clearActiveStep=function(){var e=this.getAllSteps(),n=0;for(n=0;n<e.length;n++)e[n].classList.contains("active-step")&&e[n].classList.remove("active-step")},Sequencer.prototype.deactivateSteps=function(){var e,n=this.getAllSteps();for(e=0;e<n.length;e++){var t=n[e].classList[1].split("-")[1];if(t>this.steps-1)(o=n[e].childNodes[0].childNodes[0]).classList.add("disabled-block");else if(t<this.steps){var o;(o=n[e].childNodes[0].childNodes[0]).classList.contains("disabled-block")&&o.classList.remove("disabled-block")}}},Sequencer.prototype.updateNoteKeyDisplay=function(){var e=document.querySelectorAll(".key-note-container"),n=this.notes_start+1;for(i=0;i<e.length;i++)e[i].innerHTML=`${this.notes_in_key[n].letter}${this.notes_in_key[n].sign}${this.notes_in_key[n].sequence_no}`.padEnd(3," "),n++},Sequencer.prototype.changeColorMode=function(){},Sequencer.prototype.randomSelection=function(e=null){null==e&&(e=this.auto_seed);var t=this.getBoxes();for(i=0;i<t.length;i++)t[i].classList.remove("selected"),t[i].classList.add("unselected");for(i=0;i<t.length;i++){n(16*Math.random())%i==e&&(t[i].classList.remove("unselected"),t[i].classList.add("selected"))}},Sequencer.prototype.autoModeToggle=function(){this.autoMode?this.autoMode=!1:(this.autoMode=!0,this.randomSelection(this.auto_seed))}},function(){const e=angular.module("stepScript",[]);let n=new window.Board;e.controller("mainController",["$scope",function(e){const t=window.demo_sequences;e.board=n;const o=window.Notes,s=new Dexie("ElectricLullaby");s.version(1).stores({sequences:"++id, sequence_matrix, synth_params, title, created_at"}),s.on("populate",(function(){void 0!==t&&t.forEach((function(e){e.created_at=moment().format("YYYY-MM-DD HH:mm:ss"),s.sequences.put(e).then((function(){console.log("Sequence successfully put.")})).catch((function(e){console.log(e)}))}))})),s.open();var r,c=document.getElementById("play-button").classList,a=document.getElementById("controller-container").classList;e.current_sequence_title="",e.selected_sequence_ids=[],e.notes=null,e.notes_start=0,e.displayRange="",e.range_zero=0,e.loadedSequences=[],void 0!==o&&(e.notes=o,e.notes_start=23,e.range_zero=26,e.displayRange=e.notes_start-e.range_zero,0<e.displayRange&&(e.displayRange="+"+e.displayRange)),e.notes_in_key=e.notes,e.appTitle="ElectricLullaby",e.appSubTitle="",e.logoPath="./icon.png",e.keys=[{display:"Cmaj / Amin",value:"c"},{display:"C#maj / A#min",value:"c#"},{display:"Dmaj / Bmin",value:"d"},{display:"D#maj / Cmin",value:"d#"},{display:"Emaj / C#min",value:"e"},{display:"Fmaj / Dmin",value:"f"},{display:"F#maj / D#min",value:"f#"},{display:"Gmaj / Emin",value:"g"},{display:"G#maj / Fmin",value:"g#"},{display:"Amaj / F#min",value:"a"},{display:"A#maj / Gmin",value:"a#"},{display:"Bmaj / G#min",value:"b"},{display:"Chromatic",value:"chromatic"}],e.waves=["sawtooth","sine","triangle","square","electric lullaby"],e.steps=16,e.displaySteps=e.steps,e.key=e.keys[0].value,e.wave="sine",e.tempo=240,e.displayTempo=240,e.gain=.3,e.displayVol=10*e.gain,e.detune=0,e.displayDetune=e.detune,e.sustain=2,e.displaySustain="2s",e.autoMode=!1,e.syncMode=!1,e.color_mode_value=e.board.color_mode_value,e.color_mode_btn_class=e.board.color_mode_btn_class,e.color_mode_display_txt=e.board.color_mode_display_txt,a.contains("hide")&&(a.remove("hide"),a.add("animate-display"));var l={tempo:e.tempo,key:e.key,wave:e.wave,volume:e.gain,detune:e.detune,sustain:e.sustain,step:e.steps,notes:e.notes,notes_in_key:e.notes_in_key,notes_start:e.notes_start,autoMode:e.autoMode,syncMode:e.syncMode};r=new window.Sequencer(l),e.startStopSequencer=function(){c.contains("fa-play")?(c.remove("fa-play"),c.add("fa-pause"),r.resume()):(c.remove("fa-pause"),c.add("fa-play"),r.pause())},e.setTempo=function(){e.displayTempo=e.tempo,r.setTempo(e.tempo)},e.setKey=function(){r.setKey(e.key)},e.setWave=function(){r.setWave(e.wave)},e.setVol=function(){e.displayVol=Math.round(10*e.gain*10)/10,r.setVol(e.gain)},e.setDetune=function(){e.displayDetune=0<e.detune?"+"+e.detune:e.detune,r.setDetune(10*e.detune)},e.setSustain=function(){e.displaySustain=e.sustain+"s",r.setSustain(e.sustain)},e.setRange=function(){void 0===e.notes_start||(e.displayRange=e.notes_start-e.range_zero,0<e.displayRange&&(e.displayRange="+"+e.displayRange),r.setNoteRange(e.notes_start))},e.setSteps=function(){e.displaySteps=e.steps,r.setSteps(e.steps)},e.clearBoard=function(){r.clearBoard()},e.randomSelection=function(){r.randomSelection()},e.autoModeToggle=function(n){e.autoMode=!e.autoMode,r.autoModeToggle(),e.board.toggleModeButton(n.target.id)},e.syncModeToggle=function(n){e.syncMode=!e.syncMode,e.board.toggleModeButton(n.target.id)},e.colorMode=function(){var n=e.board.colorMode();e.color_mode_value=n.color_mode_value,e.color_mode_btn_class=n.color_mode_btn_class,e.color_mode_display_txt=n.color_mode_display_txt},e.getSequencesModal=function(){e.board.getSequencesForm(),angular.element("#"+e.board.getSequencesFormModalObj.select_id).html(""),s.sequences.reverse().each((function(n){var t=n.title.padEnd(38,"%");t=t.replace(/%/g,"&nbsp;"),angular.element("#"+e.board.getSequencesFormModalObj.select_id).append(`<option value='${n.id}'>${t} ${n.created_at}</option>`)})).then((function(){})).finally((function(){}))},e.elementTimeout=function(e,n){angular.element(e).show(),setTimeout((function(){angular.element(e).fadeOut(1e3)}),n)},e.saveSequence=function(n){var t={key:e.key,wave:e.wave,steps:e.steps,gain:e.gain,note_start:e.notes_start,detune:e.detune,sustain:e.sustain,tempo:e.tempo},o={title:n,sequence_matrix:r.getSelectedBlocks(),sequence_params:t,created_at:moment().format("YYYY-MM-DD HH:mm:ss")};s.sequences.put(o).then((function(){angular.element("#"+e.board.saveSequenceFormModalObj.id).modal("hide"),angular.element("#"+e.board.saveSequenceFormModalObj.error_notification_id).html(""),angular.element("#"+e.board.saveSequenceFormModalObj.input_id).val(""),angular.element("#indexeddb-notifications-container").html("<div class='mt-2 p-2 alert alert-success font-weight-light'><i class='far fa-check-circle'></i> &nbsp;Sequence Saved!</div>"),e.elementTimeout("#indexeddb-notifications-container",5e3)})).catch((function(n){angular.element("#"+e.board.saveSequenceFormModalObj.error_notification_id).html("Something went wrong :/"),console.log(n)})).finally((function(){}))},e.putSequence=function(e){s.sequences.put(e).then((function(){console.log("Sequence successfully put.")})).catch((function(e){console.log(e)})).finally((function(){}))},e.loadSequences=function(n){e.autoMode&&e.autoModeToggle({target:{id:"auto-mode-btn"}}),e.selected_sequence_ids!=n&&(e.selected_sequence_ids=n,s.sequences.get(+n[0],(function(n){e.loadedSequences.push(n);var t=angular.element(".board-block");for(i=0;i<t.length;i++)t[i].classList.contains("selected")&&t[i].classList.remove("selected"),n.sequence_matrix.includes(i)&&(t[i].classList.add("selected"),t[i].classList.remove("unselected"));return n})).then((function(n){e.detune=n.sequence_params.detune,e.setDetune(),e.gain=n.sequence_params.gain,e.setVol(),e.key=n.sequence_params.key,e.setKey(),e.notes_start=n.sequence_params.note_start,e.setRange(),e.steps=+n.sequence_params.steps,e.setSteps(),e.sustain=n.sequence_params.sustain,e.setSustain(),e.wave=n.sequence_params.wave,e.setWave(),e.tempo=n.sequence_params.tempo,e.setTempo(),e.current_sequence_title=n.title,angular.element("#"+e.board.getSequencesFormModalObj.error_notification_id).html(""),e.$digest()})).catch((function(n){angular.element("#"+e.board.getSequencesFormModalObj.error_notification_id).html("Something went wrong :/"),console.log(n)})).finally((function(){})))},e.deleteSequences=function(n){for(i in n)s.sequences.delete(+n[i]).then((function(){angular.element("#"+e.board.getSequencesFormModalObj.error_notification_id).html("")})).catch((function(n){angular.element("#"+e.board.getSequencesFormModalObj.error_notification_id).html("Something went wrong :/"),console.log(n)})).finally((function(){}));e.getSequencesModal()},e.$watch("[wave, tempo, gain, key, detune, sustain, notes_start]",(function(n){return!e.syncMode||void(e.sync_mode_props=n)}),!0),angular.element(document).on("visibilitychange",(function(){document.hidden?r.pause():c.contains("fa-pause")&&r.resume()})),void 0!==t&&s.sequences.orderBy("created_at").first((function(n){e.loadSequences([n.id])}))}])}]);